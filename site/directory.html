<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Fatal Core Dump</title>
    <link rel="stylesheet" href="styles.css">
    <link rel="apple-touch-icon" sizes="180x180" href="apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="favicon-16x16.png">
    <link rel="manifest" href="site.webmanifest">
</head>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>

<body>
    <!-- Main Content -->
    <div class="container">
        <section class="explanation">
            <h1>Evidence Directory</h1>
            <ul>
                <li><a href="evidence/sdn_protocol_sheet.html">Station Device Network (SDN) Protocol Specification</a></li>
                <li><a href="evidence/src/airlock_ctrl.c" download>Airlock Control Source File: airlock_ctrl.c</a></li>
                <li><a href="evidence/airlock_ctrl" download>Airlock Control Binary File: airlock_ctrl</a></li>
                <li><a href="evidence/core.dump" download>Core Dump of Process Crash: core.dump</a></li>
                <li><a href="evidence/airlock_ctrl.log" download>Diagnostic Logs of airlock_ctrl Process: airlock_ctrl.log</a></li>
                <li><a href="evidence/access_logs.sql" download>Database of Airlock Access: access_logs.sql</a></li>
                <li><a href="evidence/site_msgs.eml" download>Site Email Archive: site_msgs.eml</a></li>
            </ul>
            <p>The binary and source files for additional proprietary libraries will not be provided. They have already undergone a separate audit.</p>

            <div class="button-container">
                <a href="#" class="get-started-btn" onclick="downloadAll(event)">Download All Evidence (.zip)</a>
            </div>
            <div class="button-container">
                <a href="solution_entry.html" class="get-started-btn">Report Findings</a>
            </div>

            <div class="button-container">
                <a href="assistance.html" class="get-started-btn">Request Assistance</a>
            </div>
        </section>
    </div>

    <!-- Footer -->
    <footer>
        <p>&copy; 2026 Fatal Core Dump | @VERSION@ | <a href="https://www.robopenguins.com/" target="_blank" rel="noopener noreferrer">https://www.robopenguins.com/</a></p>
    </footer>

    <script>
        async function downloadAll(e) {
            if (e) e.preventDefault();

            const button = e ? e.target : null;
            const originalText = button ? button.innerText : '';
            if (button) {
                button.innerText = 'Compressing...';
                button.style.pointerEvents = 'none';
            }

            const zip = new JSZip();
            const files = [
                'evidence/sdn_protocol_sheet.html',
                'evidence/src/airlock_ctrl.c',
                'evidence/airlock_ctrl',
                'evidence/core.dump',
                'evidence/airlock_ctrl.log',
                'evidence/access_logs.sql',
                'evidence/site_msgs.eml'
            ];

            try {
                await Promise.all(files.map(async (filename) => {
                    const response = await fetch(filename);
                    const blob = await response.blob();
                    zip.file(filename, blob);
                }));

                const content = await zip.generateAsync({ type: "blob" });
                const link = document.createElement('a');
                link.href = URL.createObjectURL(content);
                link.download = "evidence.zip";
                link.click();
            } catch (err) {
                console.error("Error zipping files:", err);
                alert("Failed to create zip file.");
            } finally {
                if (button) {
                    button.innerText = originalText;
                    button.style.pointerEvents = 'auto';
                }
            }
        }
    </script>
</body>
</html>