<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Fatal Core Dump</title>
    <link rel="stylesheet" href="styles.css">
    <link rel="apple-touch-icon" sizes="180x180" href="apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="favicon-16x16.png">
    <link rel="manifest" href="site.webmanifest">
</head>
<style>
    .autocomplete {
        /*the container must be positioned relative:*/
        position: relative;
        display: block;
        width: 100%;
    }

    .autocomplete-items {
        position: absolute;
        border: 1px solid #d4d4d4;
        border-bottom: none;
        border-top: none;
        z-index: 99;
        /*position the autocomplete items to be the same width as the container:*/
        top: 100%;
        left: 0;
        right: 0;
    }

    .autocomplete-items div {
        padding: 10px;
        cursor: pointer;
        background-color: #fff;
        border-bottom: 1px solid #d4d4d4;
        color: #333;
    }

    .autocomplete-items div:hover {
        background-color: #e9e9e9;
    }

    .autocomplete-active {
        /*when navigating through the items using the arrow keys:*/
        background-color: DodgerBlue !important;
        color: #ffffff;
    }
</style>

<body>
    <!-- Main Content -->
    <div class="container">
        <section class="explanation" id="section1">
            <h1 style="color: #ff6b6b; margin-bottom: 24px;">How did it happen?</h1>
            <form id="form1">
                <div class="form-group">
                    <h2>How did the airlock door open?</h2>
                    <div style="font-size: 1.2rem; line-height: 2.5;">
                        The
                        <div class="autocomplete" style="display: inline-block; width: 200px; vertical-align: middle;">
                            <input id="blank1" type="text" placeholder="..." required>
                        </div>
                        to call
                        <div class="autocomplete" style="display: inline-block; width: 200px; vertical-align: middle;">
                            <input id="blank2" type="text" placeholder="..." required>
                        </div>
                        was executed on the
                        <div class="autocomplete" style="display: inline-block; width: 200px; vertical-align: middle;">
                            <input id="blank3" type="text" placeholder="..." required>
                        </div>
                        .
                    </div>
                </div>

                <!-- Submit Button -->
                <div style="text-align: center; margin-top: 32px;">
                    <button type="submit" class="submit-btn">Submit Report</button>
                </div>

                <!-- Result Message -->
                <div class="result-message"></div>
            </form>
        </section>

        <section class="explanation" id="section2"
            style="display: none; margin-top: 24px; border-top: 1px solid #ccc; padding-top: 24px;">
            <form id="form2">
                <div class="form-group">
                    <h2>Where did the code that opened the airlock come from?</h2>
                    <div style="font-size: 1.2rem; line-height: 2.5;">
                        The shellcode was injected via the
                        <div class="autocomplete" style="display: inline-block; width: 300px; vertical-align: middle;">
                            <input id="blank5" type="text" placeholder="..." required>
                        </div>
                        stored in
                        <div class="autocomplete" style="display: inline-block; width: 300px; vertical-align: middle;">
                            <input id="blank6" type="text" placeholder="..." required>
                        </div>
                        .
                    </div>
                </div>

                <!-- Submit Button -->
                <div style="text-align: center; margin-top: 32px;">
                    <button type="submit" class="submit-btn">Submit Report</button>
                </div>

                <!-- Result Message -->
                <div class="result-message"></div>
            </form>
        </section>

        <section class="explanation" id="section3"
            style="display: none; margin-top: 24px; border-top: 1px solid #ccc; padding-top: 24px;">
            <form id="form3">
                <div class="form-group">
                    <h2>How did the process end up executing code on the stack?</h2>
                    <div style="font-size: 1.2rem; line-height: 2.5;">
                        A(n)
                        <div class="autocomplete" style="display: inline-block; width: 200px; vertical-align: middle;">
                            <input id="blank7" type="text" placeholder="..." required>
                        </div>
                        in
                        <div class="autocomplete" style="display: inline-block; width: 300px; vertical-align: middle;">
                            <input id="blank8" type="text" placeholder="..." required>
                        </div>
                        overwrote the
                        <div class="autocomplete" style="display: inline-block; width: 300px; vertical-align: middle;">
                            <input id="blank9" type="text" placeholder="..." required>
                        </div>
                        .
                    </div>
                </div>

                <!-- Submit Button -->
                <div style="text-align: center; margin-top: 32px;">
                    <button type="submit" class="submit-btn">Submit Report</button>
                </div>

                <!-- Result Message -->
                <div class="result-message"></div>
            </form>
        </section>

        <section class="explanation" id="section4"
            style="display: none; margin-top: 24px; border-top: 1px solid #ccc; padding-top: 24px;">
            <form id="form4">
                <div class="form-group">
                    <h2>Why didn't the bounds check on rx_message_buffer work?</h2>
                    <div style="font-size: 1.2rem; line-height: 2.5;">
                        A(n)
                        <div class="autocomplete" style="display: inline-block; width: 300px; vertical-align: middle;">
                            <input id="blank10" type="text" placeholder="..." required>
                        </div>
                        changed
                        <div class="autocomplete" style="display: inline-block; width: 300px; vertical-align: middle;">
                            <input id="blank11" type="text" placeholder="..." required>
                        </div>
                        .
                    </div>
                </div>

                <!-- Submit Button -->
                <div style="text-align: center; margin-top: 32px;">
                    <button type="submit" class="submit-btn">Submit Report</button>
                </div>

                <!-- Result Message -->
                <div class="result-message"></div>
            </form>
        </section>

        <section class="explanation" id="section5"
            style="display: none; margin-top: 24px; border-top: 1px solid #ccc; padding-top: 24px;">
            <form id="form5">
                <div class="form-group">
                    <h2>Who engineered the shellcode injection into the airlock?</h2>
                    <div style="font-size: 1.2rem; line-height: 2.5;">
                        <input id="blank12" type="text" placeholder="Name" required style="padding: 10px; width: 300px;">
                    </div>
                </div>

                <!-- Submit Button -->
                <div style="text-align: center; margin-top: 32px;">
                    <button type="submit" class="submit-btn">Submit Report</button>
                </div>

                <!-- Result Message -->
                <div class="result-message"></div>
            <div class="button-container" id="next-button" style="display: none; margin-top: 24px; text-align: center;">
                <a href="epilogue.html" class="get-started-btn">Complete Report</a>
            </div>
            </form>
        </section>

        <!-- Footer -->
        <footer>
            <p>&copy; 2026 Fatal Core Dump | @VERSION@ | <a href="https://www.robopenguins.com/">https://www.robopenguins.com/</a>
            </p>
        </footer>

        <script>
            function autocomplete(inp, arr) {
                var currentFocus;
                inp.addEventListener("input", function (e) {
                    var a, b, i, val = this.value;
                    closeAllLists();
                    if (!val) { return false; }
                    currentFocus = -1;
                    a = document.createElement("DIV");
                    a.setAttribute("id", this.id + "autocomplete-list");
                    a.setAttribute("class", "autocomplete-items");
                    this.parentNode.appendChild(a);
                    for (i = 0; i < arr.length; i++) {
                        var matchIndex = arr[i].toUpperCase().indexOf(val.toUpperCase());
                        if (matchIndex > -1) {
                            b = document.createElement("DIV");
                            b.innerHTML = arr[i].substr(0, matchIndex);
                            b.innerHTML += "<strong>" + arr[i].substr(matchIndex, val.length) + "</strong>";
                            b.innerHTML += arr[i].substr(matchIndex + val.length);
                            b.innerHTML += "<input type='hidden' value='" + arr[i] + "'>";
                            b.addEventListener("click", function (e) {
                                inp.value = this.getElementsByTagName("input")[0].value;
                                closeAllLists();
                            });
                            a.appendChild(b);
                        }
                    }
                });
                inp.addEventListener("keydown", function (e) {
                    var x = document.getElementById(this.id + "autocomplete-list");
                    if (x) x = x.getElementsByTagName("div");
                    if (e.keyCode == 40) {
                        currentFocus++;
                        addActive(x);
                    } else if (e.keyCode == 38) {
                        currentFocus--;
                        addActive(x);
                    } else if (e.keyCode == 13) {
                        e.preventDefault();
                        if (currentFocus > -1) {
                            if (x) x[currentFocus].click();
                        }
                    }
                });
                function addActive(x) {
                    if (!x) return false;
                    removeActive(x);
                    if (currentFocus >= x.length) currentFocus = 0;
                    if (currentFocus < 0) currentFocus = (x.length - 1);
                    x[currentFocus].classList.add("autocomplete-active");
                }
                function removeActive(x) {
                    for (var i = 0; i < x.length; i++) {
                        x[i].classList.remove("autocomplete-active");
                    }
                }
                function closeAllLists(elmnt) {
                    var x = document.getElementsByClassName("autocomplete-items");
                    for (var i = 0; i < x.length; i++) {
                        if (elmnt != x[i] && elmnt != inp) {
                            x[i].parentNode.removeChild(x[i]);
                        }
                    }
                }
                document.addEventListener("click", function (e) {
                    closeAllLists(e.target);
                });
            }

            var dictionary = [
                'num_handlers', 'assert', 'x86_64', 'HandleSetAirlockOpen', 'instruction', 'main', 'SDN', 'send_ptr',
                'binary', 'open', 'suit_status', 'header', 'read', 'msg_type', 'payload', 'side_idx', 'heap', 'faults',
                'health', 'stack', 'jump', 'opcode', 'length', 'type', 'good', 'airlock', 'clear', 'core',
                'door_device_id', 'airlock_pressures', 'disk', 'variable', 'int', 'function', 'strcpy', 'register',
                'message', 'response', 'station_pressure', 'flash', 'printf', 'snprintf', 'assembly', 'inside_door_id',
                'msg_header', 'error', 'debug', 'handlers', 'configuration', 'pressure_device_id', 'airlock_req',
                'state', 'heartbeat', 'message_data', 'suit_locker_id', 'pointer', 'pressure_cmd',
                'message_serialization_buffer', 'occupancy_sensor_id', 'memset', 'InitializeSDN', 'RAM',
                'num_message_handlers', 'occupancy_msg_buffer', 'call', 'apply_config_change', 'callback', 'start_time',
                'door', 'buffer', 'pressure', 'zone', 'segmentation', 'fault_mask', 'occupants', 'log', 'status',
                'HandleDebugWriteConfigInt', 'user_preferences', 'config', 'sprintf', 'id', 'fault_bits',
                'safe_to_open', 'door_fault', 'executable', 'exit_code', 'msg_buffer', 'ControlDoor',
                'use_internal_pressure', 'memcpy', 'remote_fault_clear', 'is_open', 'pressure_change_time', 'device_id',
                'idx', 'command', 'packet', 'measurement_id', 'thread', 'check', 'occupancy_resp', 'source',
                'outside_door_id', 'overflow', 'ControlPressure', 'rx_message_buffer', 'strncpy', 'code', 'dump',
                'segment', 'buffer_size_bytes', 'pressure_fault', 'LoadConfig', 'bounds', 'CheckWatchDogs', 'key',
                'msg_len', 'program', 'write', 'value', 'kernel', 'timestamp', 'handler', 'door_cmd', 'door_status',
                'process', 'HandleSetSuitOccupant', 'cmd_response', 'device', 'pressure_initialized', 'close',
                'msg_length', 'signal', 'ProcessMessageData', 'exterior_pressure', 'free', 'HandleHeartBeat', 'system',
                'invalid', 'file', 'return', 'malloc', 'HandleClearFaults', 'pressure_ctrl_id', 'interrupt', 'suit',
                'occupant', 'linux', 'now', 'airlock_state', 'memory', 'size', 'pressure_pa', 'address',
                'HandleSensorPressure', 'fault', 'zone_id', 'execute', 'sensor', 'library', 'num_occupants',
                'message_handlers', 'rx_message_buffer_size', 'failed', "SDNPressureMessage", "SDNOccupancyMessage",
                "SDNSetSuitOccupantMessage", "SDNHeartBeatMessage", "SDNSetPressureZoneMessage", "SDNSetOpenMessage",
                "SDNSetAirlockOpenMessage", "SDNClearFaultsMessage", "SDNLogMessage", "SDNResponseMessage",
                "AirlockConfig", "AirlockState", "SDNDebugWriteConfigInt"
            ];

            autocomplete(document.getElementById("blank1"), dictionary);
            autocomplete(document.getElementById("blank2"), dictionary);
            autocomplete(document.getElementById("blank3"), dictionary);
            autocomplete(document.getElementById("blank5"), dictionary);
            autocomplete(document.getElementById("blank6"), dictionary);
            autocomplete(document.getElementById("blank7"), dictionary);
            autocomplete(document.getElementById("blank8"), dictionary);
            autocomplete(document.getElementById("blank9"), dictionary);
            autocomplete(document.getElementById("blank10"), dictionary);
            autocomplete(document.getElementById("blank11"), dictionary);

            function saveProgress(level) {
                localStorage.setItem('solution_progress', level);
            }

            function loadProgress() {
                var progress = parseInt(localStorage.getItem('solution_progress') || 0);

                if (progress >= 1) {
                    document.getElementById("blank1").value = "instruction";
                    document.getElementById("blank2").value = "ControlDoor";
                    document.getElementById("blank3").value = "stack";

                    var msg = document.querySelector("#form1 .result-message");
                    msg.className = "result-message success";
                    msg.textContent = "Correct. The execution flow was redirected to the stack where a payload called ControlDoor.";
                    document.querySelector("#form1 button[type='submit']").style.display = "none";
                    document.getElementById("section2").style.display = "block";
                }

                if (progress >= 2) {
                    document.getElementById("blank5").value = "SDNSetSuitOccupantMessage";
                    document.getElementById("blank6").value = "message_serialization_buffer";

                    var msg = document.querySelector("#form2 .result-message");
                    msg.className = "result-message success";
                    msg.textContent = "Correct. A SDNSetSuitOccupantMessage message was serialized with a payload that contained machine code to open the airlock.";
                    document.querySelector("#form2 button[type='submit']").style.display = "none";
                    document.getElementById("section3").style.display = "block";
                }

                if (progress >= 3) {
                    document.getElementById("blank7").value = "overflow";
                    document.getElementById("blank8").value = "rx_message_buffer";
                    document.getElementById("blank9").value = "message_handlers";

                    var msg = document.querySelector("#form3 .result-message");
                    msg.className = "result-message success";
                    msg.textContent = "Correct. The buffer overflow overwrote the function pointers.";
                    document.querySelector("#form3 button[type='submit']").style.display = "none";
                    document.getElementById("section4").style.display = "block";
                }

                if (progress >= 4) {
                    document.getElementById("blank10").value = "SDNDebugWriteConfigInt";
                    document.getElementById("blank11").value = "rx_message_buffer_size";

                    var msg = document.querySelector("#form4 .result-message");
                    msg.className = "result-message success";
                    msg.textContent = "Correct. The debug message allowed overwriting the buffer size variable.";
                    document.querySelector("#form4 button[type='submit']").style.display = "none";
                    document.getElementById("section5").style.display = "block";
                }

                if (progress >= 5) {
                    document.getElementById("blank12").value = "Helena Efrem";

                    var msg = document.querySelector("#form5 .result-message");
                    msg.className = "result-message success";
                    msg.textContent = "Correct. Helena Efrem engineered the attack.";
                    document.querySelector("#form5 button[type='submit']").style.display = "none";
                    document.getElementById("next-button").style.display = "block";
                }
            }

            loadProgress();

            document.getElementById("form1").addEventListener("submit", function (e) {
                e.preventDefault();
                var v1 = document.getElementById("blank1").value.trim().toLowerCase();
                var v2 = document.getElementById("blank2").value.trim().toLowerCase();
                var v3 = document.getElementById("blank3").value.trim().toLowerCase();

                var msg = document.querySelector(".result-message");

                if (["instruction", "opcode", "command", "code"].includes(v1) && v2 === "ControlDoor" && v3 === "stack") {
                    msg.className = "result-message success";
                    msg.textContent = "Correct. The execution flow was redirected to the stack where a payload called ControlDoor.";
                    document.querySelector("#form1 button[type='submit']").style.display = "none";
                    document.getElementById("section2").style.display = "block";
                    saveProgress(1);
                } else {
                    msg.className = "result-message error";
                    msg.textContent = "Incorrect. Please review the debugging evidence.";
                }
            });

            document.getElementById("form2").addEventListener("submit", function (e) {
                e.preventDefault();
                var v5 = document.getElementById("blank5").value.trim().toLowerCase();
                var v6 = document.getElementById("blank6").value.trim().toLowerCase();

                var msg = document.querySelector("#form2 .result-message");

                if (["SDNSetSuitOccupantMessage", "user_preferences"].includes(v5) && ["message_serialization_buffer", "rx_message_buffer"].includes(v6)) {
                    msg.className = "result-message success";
                    msg.textContent = "Correct. A SDNSetSuitOccupantMessage message was serialized with a payload that contained machine code to open the airlock.";
                    document.querySelector("#form2 button[type='submit']").style.display = "none";
                    document.getElementById("section3").style.display = "block";
                    saveProgress(2);
                } else {
                    msg.className = "result-message error";
                    msg.textContent = "Incorrect. Please review the debugging evidence.";
                }
            });

            document.getElementById("form3").addEventListener("submit", function (e) {
                e.preventDefault();
                var v7 = document.getElementById("blank7").value.trim().toLowerCase();
                var v8 = document.getElementById("blank8").value.trim().toLowerCase();
                var v9 = document.getElementById("blank9").value.trim().toLowerCase();

                var msg = document.querySelector("#form3 .result-message");

                if (v7 === "overflow" && ["rx_message_buffer", "buffer"].includes(v8) && ["message_handlers", "handlers"].includes(v9)) {
                    msg.className = "result-message success";
                    msg.textContent = "Correct. The buffer overflow overwrote the function pointers.";
                    document.querySelector("#form3 button[type='submit']").style.display = "none";
                    document.getElementById("section4").style.display = "block";
                    saveProgress(3);
                } else {
                    msg.className = "result-message error";
                    msg.textContent = "Incorrect. Please review the debugging evidence.";
                }
            });

            document.getElementById("form4").addEventListener("submit", function (e) {
                e.preventDefault();
                var v10 = document.getElementById("blank10").value.trim().toLowerCase();
                var v11 = document.getElementById("blank11").value.trim().toLowerCase();

                var msg = document.querySelector("#form4 .result-message");

                if (v10 === "SDNDebugWriteConfigInt" && v11 === "rx_message_buffer_size") {
                    msg.className = "result-message success";
                    msg.textContent = "Correct. The debug message allowed overwriting the buffer size variable.";
                    document.querySelector("#form4 button[type='submit']").style.display = "none";
                    document.getElementById("section5").style.display = "block";
                    saveProgress(4);
                } else {
                    msg.className = "result-message error";
                    msg.textContent = "Incorrect. Please review the debugging evidence.";
                }
            });

            document.getElementById("form5").addEventListener("submit", function (e) {
                e.preventDefault();
                var v12 = document.getElementById("blank12").value.trim().toLowerCase();

                var msg = document.querySelector("#form5 .result-message");

                if (v12 === "helena" || v12 === "efrem" || v12 === "helena efrem") {
                    msg.className = "result-message success";
                    msg.textContent = "Correct. Helena Efrem engineered the injection.";
                    document.querySelector("#form5 button[type='submit']").style.display = "none";
                    document.getElementById("next-button").style.display = "block";
                    saveProgress(5);
                } else {
                    msg.className = "result-message error";
                    msg.textContent = "Incorrect. Please review the personnel records and access logs.";
                }
            });
        </script>
</body>

</html>